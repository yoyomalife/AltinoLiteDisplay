<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì•Œí‹°ë…¸ ë¼ì´íŠ¸ ë””ìŠ¤í”Œë ˆì´</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* í°íŠ¸ ì ìš© (Inter) */
        body {
            font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            -webkit-tap-highlight-color: transparent; /* ëª¨ë°”ì¼ í´ë¦­ ì‹œ íŒŒë€ìƒ‰ í•˜ì´ë¼ì´íŠ¸ ì œê±° */
        }
        /* ê·¸ë¦¬ë“œ ì…€ì˜ í¬ê¸°ë¥¼ ë·°í¬íŠ¸ì— ë”°ë¼ ì¡°ì ˆí•˜ê³  ì •ì‚¬ê°í˜• ë¹„ìœ¨ ìœ ì§€ (ìˆ˜ì •ë¨) */
        .grid-cell {
            width: 10vw; /* ë·°í¬íŠ¸ ë„ˆë¹„ì˜ 10% */
            max-width: 40px; /* ìµœëŒ€ í¬ê¸° ì œí•œ */
            aspect-ratio: 1 / 1; /* ì •ì‚¬ê°í˜• ë¹„ìœ¨ ê°•ì œ */
            user-select: none; /* í…ìŠ¤íŠ¸ ì„ íƒ ë°©ì§€ */
            /* heightì™€ max-heightëŠ” aspect-ratioê°€ ì²˜ë¦¬í•˜ë„ë¡ ì œê±° */
        }
        /* ë¼ë²¨ ìŠ¤íƒ€ì¼ */
        .axis-label {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem; /* 12px */
            color: #4B5563; /* gray-600 */
            font-weight: 500;
        }
        /* í•©ê³„ ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
        .hex-sum-box {
            font-family: 'Courier New', Courier, monospace; /* ë³µì‚¬ ë¬¸ìì—´ê³¼ ë™ì¼í•œ í°íŠ¸ */
            font-weight: 600;
            font-size: 0.875rem; /* 14px */
            padding: 0.25rem;
            background-color: #F3F4F6; /* gray-100 */
            border: 1px solid #D1D5DB; /* gray-300 */
            border-radius: 0.375rem; /* 6px */
            text-align: center;
            height: 40px; /* ê³ ì • ë†’ì´ */
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1D4ED8; /* íŒŒë€ ê³„ì—´ (Tailwind blue-700) */
        }
        /* 16ì§„ìˆ˜ í•©ê³„ ìœ„ì˜ ì—´ ë¼ë²¨ */
        .col-sum-label {
            font-size: 0.75rem; /* 12px */
            color: #4B5563; /* gray-600 */
            font-weight: 500;
            text-align: center;
            margin-bottom: 0.25rem; /* 4px */
        }
    </style>
</head>
<body class="bg-gray-50 flex items-center justify-center min-h-screen p-4">

    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
    <div class="bg-white p-4 sm:p-6 rounded-2xl shadow-xl w-full max-w-md mx-auto">
        
        <!-- ì œëª© (ê·¸ë¼ë°ì´ì…˜ ì ìš©) -->
        <h1 class="text-2xl sm:text-3xl font-bold text-center text-transparent bg-clip-text bg-gradient-to-r from-teal-500 to-blue-600 mb-2">
            ì•Œí‹°ë…¸ ë¼ì´íŠ¸ ë””ìŠ¤í”Œë ˆì´
        </h1>

        <!-- ê·¸ë¦¬ë“œ ë° ë¼ë²¨ ì»¨í…Œì´ë„ˆ (ìˆ˜ì •ë¨) -->
        <div class="mt-6">
            <!-- IDë¥¼ ë¶€ì—¬í•˜ì—¬ JSê°€ ì œì–´í•˜ë„ë¡ ë³€ê²½ -->
            <div id="main-grid" class="grid grid-cols-9 gap-1 items-center">
                <!-- JavaScriptë¡œ Yì¶• ë¼ë²¨, 8x8 ê·¸ë¦¬ë“œ, Xì¶• ë¼ë²¨ì´ ë™ì  ìƒì„±ë©ë‹ˆë‹¤. -->
            </div>
        </div>

        <!-- 16ì§„ìˆ˜ í•©ê³„ ë””ìŠ¤í”Œë ˆì´ -->
        <div class="mt-6">
            <div id="hex-sum-container" class="grid grid-cols-8 gap-1">
                <!-- JavaScriptë¡œ ë™ì  ìƒì„±ë¨ -->
            </div>
        </div>

        <!-- 16ì§„ìˆ˜ ê°’ ë¬¸ìì—´ ë° ë³µì‚¬ ë²„íŠ¼ -->
        <div class="mt-4 p-3 bg-gray-100 rounded-lg flex items-center justify-between space-x-2">
            <code id="display-line-string" class="text-sm text-gray-700 whitespace-nowrap overflow-x-auto overflow-y-hidden pb-1" style="font-family: 'Courier New', Courier, monospace;">
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
            </code>
            <button id="copy-button" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-medium py-1.5 px-3 rounded-md text-xs transition-colors duration-200 flex-shrink-0">
                ë³µì‚¬
            </button>
        </div>


        <!-- AI ì´ë¯¸ì§€ ìƒì„± (í‚¤ì›Œë“œ ì…ë ¥ + ë²„íŠ¼) - (ì œê±°ë¨) -->
        <!-- AI ìƒíƒœ ë©”ì‹œì§€ - (ì œê±°ë¨) -->

        <!-- ë¦¬ì…‹ ë²„íŠ¼ (ì œì¼ í•˜ë‹¨ìœ¼ë¡œ ì´ë™ ë° ìƒë‹¨ ë§ˆì§„ ì¶”ê°€) -->
        <!-- AI ì„¹ì…˜ì´ ë¹ ì¡Œìœ¼ë¯€ë¡œ mt-8ë¡œ ìƒë‹¨ ë§ˆì§„ì„ ì¡°ì •í•©ë‹ˆë‹¤. -->
        <button id="reset-button" class="mt-8 w-full bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-200">
            ğŸ”„ ì²˜ìŒë¶€í„° ë‹¤ì‹œí•˜ê¸°
        </button>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const gridContainer = document.getElementById('main-grid'); // IDë¡œ ì„ íƒ
            const hexSumContainer = document.getElementById('hex-sum-container');
            const resetButton = document.getElementById('reset-button');
            const displayLineString = document.getElementById('display-line-string');
            const copyButton = document.getElementById('copy-button');

            // AI ìƒì„± ê´€ë ¨ UI ìš”ì†Œ (ì œê±°ë¨)
            
            // Yì¶• ë¼ë²¨ (í–‰) - ìƒë‹¨(0x80)ë¶€í„° í•˜ë‹¨(0x01) ìˆœì„œë¡œ ë³€ê²½
            const yLabels = ['0x80', '0x40', '0x20', '0x10', '0x08', '0x04', '0x02', '0x01'];
            // Xì¶• ë¼ë²¨ (ì—´)
            const xLabels = ['1', '2', '3', '4', '5', '6', '7', '8'];

            // --- 1. 8x8 ê·¸ë¦¬ë“œ ë° ë¼ë²¨ UI ìƒì„± (ìˆ˜ì •ë¨) ---

            // 1-1. Yì¶• ë¼ë²¨ (í–‰) ë° 8x8 ê·¸ë¦¬ë“œ ì…€ ìƒì„±
            yLabels.forEach(rowLabel => {
                // Yì¶• ë¼ë²¨ (í–‰)
                const yLabelDiv = document.createElement('div');
                yLabelDiv.className = 'axis-label';
                yLabelDiv.textContent = rowLabel;
                gridContainer.appendChild(yLabelDiv);

                // 8ê°œì˜ ê·¸ë¦¬ë“œ ì…€
                xLabels.forEach(colLabel => {
                    const cell = document.createElement('div');
                    cell.className = 'grid-cell bg-gray-200 rounded-md cursor-pointer transition-colors duration-150';
                    cell.dataset.row = rowLabel; // í–‰ ê°’ (ì˜ˆ: 0x80)
                    cell.dataset.col = colLabel; // ì—´ ê°’ (ì˜ˆ: 1)
                    gridContainer.appendChild(cell);
                });
            });

            // 1-1-B. Xì¶• ë¼ë²¨ (ì—´)ì„ í•˜ë‹¨ì— ìƒì„± (ìƒˆë¡œ ì¶”ê°€)
            // (0,0) ë¹ˆ ì½”ë„ˆ
            gridContainer.appendChild(document.createElement('div'));

            // 8ê°œì˜ Xì¶• ë¼ë²¨
            xLabels.forEach(colLabel => {
                const xLabelDiv = document.createElement('div');
                xLabelDiv.className = 'axis-label pt-2'; // ìƒë‹¨ íŒ¨ë”©(pt-2) ì¶”ê°€
                xLabelDiv.textContent = colLabel;
                gridContainer.appendChild(xLabelDiv);
            });


            // 1-2. 16ì§„ìˆ˜ í•©ê³„ ë””ìŠ¤í”Œë ˆì´ ìƒì„±
            xLabels.forEach(colLabel => {
                const colWrapper = document.createElement('div');
                
                const labelDiv = document.createElement('div');
                labelDiv.className = 'col-sum-label';
                labelDiv.textContent = `${colLabel}ì—´`; // "nì—´" í˜•ì‹
                colWrapper.appendChild(labelDiv);

                const sumBox = document.createElement('div');
                sumBox.className = 'hex-sum-box';
                sumBox.id = `hex-sum-${colLabel}`; // ID ë¶€ì—¬ (ì˜ˆ: hex-sum-1)
                sumBox.textContent = '0x00';
                colWrapper.appendChild(sumBox);

                hexSumContainer.appendChild(colWrapper);
            });

            // --- 2. í•µì‹¬ ë¡œì§ í•¨ìˆ˜ ---

            /**
             * ê° ì—´ì˜ 16ì§„ìˆ˜ í•©ê³„ë¥¼ ê³„ì‚°í•˜ê³  UIë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
             */
            function updateHexSums() {
                const columnSums = {}; // ì˜ˆ: { '1': 0, '2': 0, ... }
                xLabels.forEach(col => columnSums[col] = 0);

                // ëª¨ë“  í™œì„±í™”ëœ(ë¹¨ê°„ìƒ‰) ì…€ ì°¾ê¸°
                const activeCells = document.querySelectorAll('.grid-cell.bg-red-500');

                activeCells.forEach(cell => {
                    const col = cell.dataset.col; // '1', '2', ...
                    const rowHexValue = parseInt(cell.dataset.row); // '0x80' -> 128
                    
                    if (columnSums[col] !== undefined) {
                        columnSums[col] |= rowHexValue; // ë¹„íŠ¸ OR ì—°ì‚°ìœ¼ë¡œ í•©ì‚°
                    }
                });

                // UI ì—…ë°ì´íŠ¸
                const hexValues = []; // DisplayLineìš© ë°°ì—´
                xLabels.forEach(col => {
                    const sum = columnSums[col];
                    const hexString = '0x' + sum.toString(16).toUpperCase().padStart(2, '0');
                    document.getElementById(`hex-sum-${col}`).textContent = hexString;
                    hexValues.push(hexString);
                });

                // 16ì§„ìˆ˜ ê°’ ë¬¸ìì—´ ì—…ë°ì´íŠ¸ (DisplayLine() ì œê±°)
                displayLineString.textContent = hexValues.join(', ');
            }

            // --- 3. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ ---

            // 3-1. ì…€ í´ë¦­ ì´ë²¤íŠ¸ (ì´ë²¤íŠ¸ ìœ„ì„ ì‚¬ìš©)
            gridContainer.addEventListener('click', (event) => {
                // í´ë¦­ëœ ìš”ì†Œê°€ .grid-cellì¸ì§€ í™•ì¸
                if (event.target.classList.contains('grid-cell')) {
                    const cell = event.target;
                    // í´ë˜ìŠ¤ë¥¼ í† ê¸€ (ë¹¨ê°„ìƒ‰ <-> íšŒìƒ‰)
                    cell.classList.toggle('bg-red-500');
                    cell.classList.toggle('bg-gray-200');
                    
                    // 16ì§„ìˆ˜ í•©ê³„ ë‹¤ì‹œ ê³„ì‚°
                    updateHexSums();
                }
            });

            // 3-2. ë¦¬ì…‹ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
            resetButton.addEventListener('click', () => {
                const allCells = document.querySelectorAll('.grid-cell');
                allCells.forEach(cell => {
                    cell.classList.remove('bg-red-500');
                    cell.classList.add('bg-gray-200');
                });
                
                // 16ì§„ìˆ˜ í•©ê³„ ì—…ë°ì´íŠ¸ (0ìœ¼ë¡œ ë¦¬ì…‹)
                updateHexSums();
                
                // AI ì…ë ¥ ë° ìƒíƒœ ì´ˆê¸°í™” (ì œê±°ë¨)
            });

            // 3-3. ë³µì‚¬ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
            copyButton.addEventListener('click', () => {
                // ì´ì œ displayLineString.textContentëŠ” "0x00, 0x00, ..." í˜•ì‹ì„
                const textToCopy = displayLineString.textContent;

                // document.execCommandë¥¼ ì‚¬ìš©í•œ í´ë¦½ë³´ë“œ ë³µì‚¬ (iFrame í˜¸í™˜ì„±)
                try {
                    const tempTextArea = document.createElement('textarea');
                    tempTextArea.value = textToCopy;
                    tempTextArea.style.position = 'absolute';
                    tempTextArea.style.left = '-9999px'; // í™”ë©´ ë°–ìœ¼ë¡œ
                    document.body.appendChild(tempTextArea);
                    
                    tempTextArea.select();
                    tempTextArea.setSelectionRange(0, 99999); // ëª¨ë°”ì¼ ê¸°ê¸° í˜¸í™˜ì„±

                    document.execCommand('copy');
                    
                    document.body.removeChild(tempTextArea);

                    // ì‚¬ìš©ì í”¼ë“œë°±
                    copyButton.textContent = 'ë³µì‚¬ ì™„ë£Œ!';
                    copyButton.classList.add('bg-green-500', 'text-white');
                    copyButton.classList.remove('bg-gray-300', 'hover:bg-gray-400', 'text-gray-800');
                    
                    setTimeout(() => {
                        copyButton.textContent = 'ë³µì‚¬';
                        copyButton.classList.remove('bg-green-500', 'text-white');
                        copyButton.classList.add('bg-gray-300', 'hover:bg-gray-400', 'text-gray-800');
                    }, 2000);

                } catch (err) {
                    console.error('í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:', err);
                    // ì‹¤íŒ¨ ì‹œ ì‚¬ìš©ì í”¼ë“œë°± (ì˜ˆ: alert ëŒ€ì‹ )
                    copyButton.textContent = 'ë³µì‚¬ ì‹¤íŒ¨';
                    copyButton.classList.add('bg-red-500', 'text-white');
                    setTimeout(() => {
                        copyButton.textContent = 'ë³µì‚¬';
                        copyButton.classList.remove('bg-red-500', 'text-white');
                    }, 2000);
                }
            });


            // --- Helper: API Exponential Backoff --- (ì œê±°ë¨)
            // --- 4. AI íŒ¨í„´ ìƒì„± í•¨ìˆ˜ --- (ì œê±°ë¨)
            // --- 5. UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜ --- (ì œê±°ë¨)
            // 3-4. AI ì´ë¯¸ì§€ ìƒì„± ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ (ì œê±°ë¨)


            // --- 6. ì´ˆê¸°í™” ---
            // í˜ì´ì§€ ë¡œë“œ ì‹œ í•©ê³„ ë””ìŠ¤í”Œë ˆì´ ì´ˆê¸°í™”
            updateHexSums();
        });
    </script>
</body>
</html>
